2023-04-06 21:47:37,441 - INFO - [MainThread] - Initialized router P4 at port 5004 PID 6519
2023-04-06 21:47:37,447 - INFO - [MainThread] - Adding a connection to LupusreginaBeta
2023-04-06 21:47:37,447 - INFO - [Connect-LupusreginaBeta] - Calling connect_to_rendezvous_point
2023-04-06 21:47:37,447 - INFO - [Connect-LupusreginaBeta] - Connect to rendezvous point LupusreginaBeta
2023-04-06 21:47:37,449 - INFO - [MainThread] - Adding listener for Vulnerar
2023-04-06 21:47:37,450 - INFO - [Establish-Vulnerar] - Establishing RP to Vulnerar
2023-04-06 21:47:37,452 - INFO - [MainThread] - Starting testing thread
2023-04-06 21:47:37,455 - INFO - [TESTER] - Started tester
2023-04-06 21:47:37,455 - INFO - [MainThread] - Starting connection thread
2023-04-06 21:47:37,462 - INFO - [Establish-Vulnerar] - Loading cached NetworkStatusDocument from TorCacheDirStorage: /root/.local/share/torpy/network_status
2023-04-06 21:47:37,469 - INFO - [MainThread] - Starting log thread
2023-04-06 21:47:37,469 - INFO - [Connect-LupusreginaBeta] - Loading cached NetworkStatusDocument from TorCacheDirStorage: /root/.local/share/torpy/network_status
2023-04-06 21:47:38,074 - INFO - [Establish-Vulnerar] - Loading cached DirKeyCertificateList from TorCacheDirStorage: /root/.local/share/torpy/dir_key_certificates
2023-04-06 21:47:38,076 - INFO - [Establish-Vulnerar] - Connecting to guard node 185.181.61.23:443 (staysafeandgoodluck; Tor 0.4.7.13)... (None)
2023-04-06 21:47:38,078 - INFO - [Connect-LupusreginaBeta] - Loading cached DirKeyCertificateList from TorCacheDirStorage: /root/.local/share/torpy/dir_key_certificates
2023-04-06 21:47:38,133 - INFO - [Establish-Vulnerar] - Creating new circuit #80000001 with 185.181.61.23:443 (staysafeandgoodluck; Tor 0.4.7.13) router...
2023-04-06 21:47:38,147 - INFO - [Establish-Vulnerar] - Building -1 hops circuit...
2023-04-06 21:47:38,147 - INFO - [Establish-Vulnerar] - Extending the circuit #80000001 with 157.90.179.103:8001 (Vulnerar; Tor 0.4.7.13)...
2023-04-06 21:47:38,147 - INFO - [Establish-Vulnerar] - Getting descriptor for 157.90.179.103:8001 (Vulnerar; Tor 0.4.7.13)...
2023-04-06 21:47:38,152 - INFO - [Establish-Vulnerar] - Connecting to guard node 217.79.252.202:443 (galapagoo; Tor 0.4.7.10)... (Internal dir client)
2023-04-06 21:47:38,189 - INFO - [Connect-LupusreginaBeta] - Connected to rendezvous point LupusreginaBeta
2023-04-06 21:47:38,197 - INFO - [Connect-LupusreginaBeta] - Waiting for peer to open stream
2023-04-06 21:47:38,239 - INFO - [Connect-LupusreginaBeta] - Received cell: <class 'torpy.cells.CellRelay'>
2023-04-06 21:47:38,239 - INFO - [Connect-LupusreginaBeta] - Stream opened successfully
2023-04-06 21:47:38,240 - INFO - [Connect-LupusreginaBeta] - Sending HELLO to peer: b'\x80\x04\x95&\x00\x00\x00\x00\x00\x00\x00]\x94}\x94(\x8c\x07Message\x94\x8c\x05HELLO\x94\x8c\x04Peer\x94\x8c\x02P4\x94ua.'
2023-04-06 21:47:38,444 - INFO - [RECEIVER] - Added neighbour P2
2023-04-06 21:47:38,702 - INFO - [Establish-Vulnerar] - Creating new circuit #80000002 with 217.79.252.202:443 (galapagoo; Tor 0.4.7.10) router...
2023-04-06 21:47:38,841 - INFO - [Establish-Vulnerar] - Building 0 hops circuit...
2023-04-06 21:47:38,841 - INFO - [Establish-Vulnerar] - Stream #1: creating attached to #80000002 circuit...
2023-04-06 21:47:38,841 - INFO - [Establish-Vulnerar] - Stream #1: connecting to hsdir
2023-04-06 21:47:38,980 - INFO - [RecvLoop_217.79.] - Stream #1: connected (remote ip '')
2023-04-06 21:47:39,314 - INFO - [RecvLoop_217.79.] - Stream #1: remote disconnected (reason = DONE)
2023-04-06 21:47:39,315 - INFO - [Establish-Vulnerar] - Stream #1: closing (state = Disconnected)...
2023-04-06 21:47:39,315 - INFO - [Establish-Vulnerar] - Got descriptor
2023-04-06 21:47:39,379 - INFO - [Establish-Vulnerar] - <class 'torpy.circuit.TorCircuit'>
2023-04-06 21:47:39,431 - INFO - [Establish-Vulnerar] - Rendezvous established (CellRelayRendezvousEstablished())
2023-04-06 21:47:39,431 - INFO - [Establish-Vulnerar] - Waiting for connections at relay Vulnerar for cookie b'eb688e4f52df90278060' ...
2023-04-06 21:47:44,620 - INFO - [Establish-Vulnerar] - Got REND2 message from Vulnerar
2023-04-06 21:47:44,620 - INFO - [Establish-Vulnerar] - Entered circuit context with id 0x80000001
2023-04-06 21:47:44,620 - INFO - [Establish-Vulnerar] - Stream #2: creating attached to #80000001 circuit...
2023-04-06 21:47:44,620 - INFO - [Establish-Vulnerar] - Stream #2: connecting to ('127.0.0.1', 5000)
2023-04-06 21:47:44,723 - INFO - [RecvLoop_185.181] - Stream #2: connected (remote ip '127.0.0.1')
2023-04-06 21:47:44,822 - INFO - [Establish-Vulnerar] - Sending HELLO to peer
2023-04-06 21:47:44,822 - INFO - [Establish-Vulnerar] - Sending HELLO to peer: b'\x80\x04\x95&\x00\x00\x00\x00\x00\x00\x00]\x94}\x94(\x8c\x07Message\x94\x8c\x05HELLO\x94\x8c\x04Peer\x94\x8c\x02P4\x94ua.'
2023-04-06 21:47:45,547 - INFO - [RECEIVER] - Added neighbour P3
2023-04-06 21:47:45,547 - WARNING - [RECEIVER] - Routing loop from P2 to P3: P2-P4-P2-P4
2023-04-06 21:48:43,306 - INFO - [RecvLoop_217.79.] - On destroy: circuit #80000002
2023-04-06 21:48:43,306 - INFO - [RecvLoop_217.79.] - Destroy circuit #80000002
2023-04-06 21:48:43,469 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:49:57,684 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:49:57,701 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:51:07,775 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:52:22,864 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:52:22,883 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:52:52,899 - INFO - [RecvLoop_185.181] - On destroy: circuit #80000001
2023-04-06 21:52:52,900 - INFO - [RecvLoop_185.181] - Destroy circuit #80000001
2023-04-06 21:52:52,900 - INFO - [RecvLoop_185.181] - Stream #2: closing (state = Connected)...
2023-04-06 21:53:07,763 - INFO - [Thread-4] - Adding P3 to list of inactive
2023-04-06 21:53:07,763 - INFO - [Thread-4] - DEAD ROUTES DETECTED: P3
2023-04-06 21:53:07,763 - INFO - [Thread-4] - Removing P3 from neighbours
2023-04-06 21:53:07,764 - INFO - [Thread-4] - Removed circuit for P3
2023-04-06 21:53:07,764 - INFO - [Thread-4] - updateGraphOnly: [['P1', 'P2', 610, 'sklep'], ['P1', 'P3', 570, 'RMK'], ['P3', 'P4', 324, 'Vulnerar'], ['P2', 'P4', 490, 'LupusreginaBeta']] , {'P3'}
2023-04-06 21:53:08,767 - INFO - [Thread-4] - GRAPH: [['P1', 'P2', 610, 'sklep'], ['P1', 'P3', 570, 'RMK'], ['P2', 'P4', 490, 'LupusreginaBeta']]
2023-04-06 21:53:08,767 - INFO - [Thread-4] - ROUTER: {'RID': 'P4', 'Port': 5004, 'Neighbours': 1, 'Neighbours Data': [{'NID': 'P2', 'Cost': 886, 'Hostname': '127.0.0.1', 'RP': 'LupusreginaBeta', 'FLAG': 0}], 'SN': 15, 'FLAG': 0, 'RP': set()}
2023-04-06 21:53:08,767 - INFO - [Thread-4] - LSA_DB: {'P1': {'RID': 'P1', 'Port': 5001, 'Neighbours': 2, 'Neighbours Data': [{'NID': 'P2', 'Cost': 610, 'Hostname': '127.0.0.1', 'RP': 'sklep', 'FLAG': 0}, {'NID': 'P3', 'Cost': 570, 'Hostname': '127.0.0.1', 'RP': 'RMK', 'FLAG': 0}], 'SN': 14, 'FLAG': 1, 'RP': set()}, 'P2': {'RID': 'P2', 'Port': 5002, 'Neighbours': 2, 'Neighbours Data': [{'NID': 'P1', 'Cost': 624, 'Hostname': '127.0.0.1', 'RP': 'sklep', 'FLAG': 0}, {'NID': 'P4', 'Cost': 490, 'Hostname': '127.0.0.1', 'RP': 'LupusreginaBeta', 'FLAG': 0}], 'SN': 14, 'FLAG': 1, 'RP': set()}}
2023-04-06 21:53:12,779 - INFO - [RECEIVER] - updateGraphOnly: [['P1', 'P2', 610, 'sklep'], ['P1', 'P3', 570, 'RMK'], ['P2', 'P4', 490, 'LupusreginaBeta']] , {'P3'}
2023-04-06 21:53:15,869 - ERROR - [RECEIVER] - send_to_stream: Key not found: 'P3'
2023-04-06 21:53:16,903 - ERROR - [RECEIVER] - send_to_stream: Key not found: 'P3'
2023-04-06 21:53:23,968 - ERROR - [RECEIVER] - send_to_stream: Key not found: 'P3'
2023-04-06 21:53:28,080 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:53:32,015 - ERROR - [RECEIVER] - send_to_stream: Key not found: 'P3'
2023-04-06 21:53:37,790 - INFO - [CONNECTION] - Neighbour connections (1) less than MIN_NEIGHBOUR_CONNECTIONS (2)
2023-04-06 21:53:37,790 - INFO - [CONNECTION] - Candidate peers: ['P1']
2023-04-06 21:53:37,790 - INFO - [CONNECTION] - Highest cost peers: [('P3', 1670), ('P1', 544), ('P2', 444), ('P4', 0)]
2023-04-06 21:53:37,794 - INFO - [CONNECTION] - Loading cached NetworkStatusDocument from TorCacheDirStorage: /root/.local/share/torpy/network_status
2023-04-06 21:53:38,251 - INFO - [CONNECTION] - Loading cached DirKeyCertificateList from TorCacheDirStorage: /root/.local/share/torpy/dir_key_certificates
2023-04-06 21:53:38,261 - INFO - [MainThread] - ['ESTABLISH', 'ljubo87bg', b'2acdd56e0556537a7afa']
2023-04-06 21:53:38,261 - INFO - [MainThread] - Got ESTABLISH to relay ljubo87bg:b'2acdd56e0556537a7afa' via staysafeandgoodluck
2023-04-06 21:53:38,261 - INFO - [Establish-ljubo87bg] - Establishing RP to ljubo87bg
2023-04-06 21:53:38,268 - INFO - [Establish-ljubo87bg] - Loading cached NetworkStatusDocument from TorCacheDirStorage: /root/.local/share/torpy/network_status
2023-04-06 21:53:38,721 - INFO - [Establish-ljubo87bg] - Loading cached DirKeyCertificateList from TorCacheDirStorage: /root/.local/share/torpy/dir_key_certificates
2023-04-06 21:53:38,724 - INFO - [Establish-ljubo87bg] - Connecting to guard node 185.181.61.23:443 (staysafeandgoodluck; Tor 0.4.7.13)... (None)
2023-04-06 21:53:38,785 - INFO - [Establish-ljubo87bg] - Creating new circuit #80000003 with 185.181.61.23:443 (staysafeandgoodluck; Tor 0.4.7.13) router...
2023-04-06 21:53:38,800 - INFO - [Establish-ljubo87bg] - Building -1 hops circuit...
2023-04-06 21:53:38,800 - INFO - [Establish-ljubo87bg] - Extending the circuit #80000003 with 152.67.109.242:9001 (ljubo87bg; Tor 0.4.7.7)...
2023-04-06 21:53:38,803 - INFO - [Establish-ljubo87bg] - Getting descriptor for 152.67.109.242:9001 (ljubo87bg; Tor 0.4.7.7)...
2023-04-06 21:53:38,809 - INFO - [Establish-ljubo87bg] - Connecting to guard node 95.217.135.250:443 (Tethys; Tor 0.4.7.13)... (Internal dir client)
2023-04-06 21:53:38,907 - INFO - [Establish-ljubo87bg] - Creating new circuit #80000004 with 95.217.135.250:443 (Tethys; Tor 0.4.7.13) router...
2023-04-06 21:53:38,931 - INFO - [Establish-ljubo87bg] - Building 0 hops circuit...
2023-04-06 21:53:38,931 - INFO - [Establish-ljubo87bg] - Stream #3: creating attached to #80000004 circuit...
2023-04-06 21:53:38,931 - INFO - [Establish-ljubo87bg] - Stream #3: connecting to hsdir
2023-04-06 21:53:38,956 - INFO - [RecvLoop_95.217.] - Stream #3: connected (remote ip '')
2023-04-06 21:53:39,057 - ERROR - [RECEIVER] - send_to_stream: Key not found: 'P3'
2023-04-06 21:53:39,159 - INFO - [RecvLoop_95.217.] - Stream #3: remote disconnected (reason = DONE)
2023-04-06 21:53:39,160 - INFO - [Establish-ljubo87bg] - Stream #3: closing (state = Disconnected)...
2023-04-06 21:53:39,160 - INFO - [Establish-ljubo87bg] - Got descriptor
2023-04-06 21:53:39,501 - INFO - [Establish-ljubo87bg] - <class 'torpy.circuit.TorCircuit'>
2023-04-06 21:53:39,825 - INFO - [Establish-ljubo87bg] - Rendezvous established (CellRelayRendezvousEstablished())
2023-04-06 21:53:39,826 - INFO - [Establish-ljubo87bg] - Waiting for connections at relay ljubo87bg for cookie b'2acdd56e0556537a7afa' ...
2023-04-06 21:53:48,271 - INFO - [CONNECTION] - Sending JOIN to P1 at relay ljubo87bg
2023-04-06 21:53:49,746 - ERROR - [Establish-Vulnerar] - recv timeout
2023-04-06 21:53:49,746 - INFO - [Establish-Vulnerar] - Closing connection Establish-Vulnerar
2023-04-06 21:53:49,746 - INFO - [Establish-Vulnerar] - Stream #2: closing (state = Closed)...
2023-04-06 21:53:49,746 - WARNING - [Establish-Vulnerar] - Stream #2: closed already
2023-04-06 21:53:49,746 - INFO - [Establish-Vulnerar] - Destroy circuit #80000001
2023-04-06 21:53:49,746 - WARNING - [Establish-Vulnerar] - #80000001 circuit: has been destroyed already
2023-04-06 21:53:49,746 - INFO - [Establish-Vulnerar] - Closing guard connections (None)...
2023-04-06 21:54:33,077 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:54:33,140 - WARNING - [Connect-LupusreginaBeta] - Got SENDME
2023-04-06 21:54:33,347 - INFO - [RECEIVER] - Added relay ElRelayoReturns from P1 to JOIN queue
2023-04-06 21:54:33,347 - INFO - [MainThread] - ['JOIN', 'ElRelayoReturns', b'2acdd56e0556537a7afa']
2023-04-06 21:54:33,348 - INFO - [MainThread] - Got JOIN to relay ElRelayoReturns, waiting 10 sec to connect
2023-04-06 21:54:33,348 - INFO - [Connect-ElRelayoReturns] - Calling connect_to_rendezvous_point
2023-04-06 21:54:33,348 - INFO - [Connect-ElRelayoReturns] - Connect to rendezvous point ElRelayoReturns
2023-04-06 21:54:33,363 - INFO - [Connect-ElRelayoReturns] - Loading cached NetworkStatusDocument from TorCacheDirStorage: /root/.local/share/torpy/network_status
2023-04-06 21:54:33,899 - INFO - [Connect-ElRelayoReturns] - Loading cached DirKeyCertificateList from TorCacheDirStorage: /root/.local/share/torpy/dir_key_certificates
2023-04-06 21:54:34,554 - INFO - [Connect-ElRelayoReturns] - Connected to rendezvous point ElRelayoReturns
2023-04-06 21:54:34,555 - INFO - [Connect-ElRelayoReturns] - Waiting for peer to open stream
2023-04-06 21:54:34,860 - INFO - [Connect-ElRelayoReturns] - Received cell: <class 'torpy.cells.CellRelay'>
2023-04-06 21:54:34,860 - INFO - [Connect-ElRelayoReturns] - Stream opened successfully
2023-04-06 21:54:34,861 - INFO - [Connect-ElRelayoReturns] - Sending HELLO to peer: b'\x80\x04\x95&\x00\x00\x00\x00\x00\x00\x00]\x94}\x94(\x8c\x07Message\x94\x8c\x05HELLO\x94\x8c\x04Peer\x94\x8c\x02P4\x94ua.'
2023-04-06 21:54:35,269 - INFO - [RECEIVER] - Added neighbour P1
2023-04-06 21:54:39,750 - INFO - [RECEIVER] - Added relay SoftPower from P2 to JOIN queue
2023-04-06 21:54:39,751 - INFO - [MainThread] - ['JOIN', 'SoftPower', b'2acdd56e0556537a7afa']
2023-04-06 21:54:39,751 - INFO - [MainThread] - Got JOIN to relay SoftPower, waiting 10 sec to connect
2023-04-06 21:54:39,751 - INFO - [Connect-SoftPower] - Calling connect_to_rendezvous_point
2023-04-06 21:54:39,751 - INFO - [Connect-SoftPower] - Connect to rendezvous point SoftPower
2023-04-06 21:54:39,768 - INFO - [Connect-SoftPower] - Loading cached NetworkStatusDocument from TorCacheDirStorage: /root/.local/share/torpy/network_status
2023-04-06 21:54:40,281 - INFO - [Connect-SoftPower] - Loading cached DirKeyCertificateList from TorCacheDirStorage: /root/.local/share/torpy/dir_key_certificates
2023-04-06 21:54:41,644 - INFO - [Connect-SoftPower] - Connected to rendezvous point SoftPower
2023-04-06 21:54:41,644 - INFO - [Connect-SoftPower] - Waiting for peer to open stream
2023-04-06 21:54:43,127 - INFO - [Connect-SoftPower] - Received cell: <class 'torpy.cells.CellRelay'>
2023-04-06 21:54:43,130 - INFO - [Connect-SoftPower] - Stream opened successfully
2023-04-06 21:54:43,131 - INFO - [Connect-SoftPower] - Sending HELLO to peer: b'\x80\x04\x95&\x00\x00\x00\x00\x00\x00\x00]\x94}\x94(\x8c\x07Message\x94\x8c\x05HELLO\x94\x8c\x04Peer\x94\x8c\x02P4\x94ua.'
2023-04-06 21:54:44,774 - INFO - [RECEIVER] - Added neighbour P2
2023-04-06 21:54:48,077 - INFO - [RecvLoop_95.217.] - On destroy: circuit #80000004
2023-04-06 21:54:48,077 - INFO - [RecvLoop_95.217.] - Destroy circuit #80000004
2023-04-06 21:55:44,128 - ERROR - [Connect-LupusreginaBeta] - Got RELAY_END
2023-04-06 21:55:53,444 - WARNING - [Connect-ElRelayoReturns] - Got SENDME
2023-04-06 21:56:00,395 - WARNING - [Connect-SoftPower] - Got SENDME
